(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var canvas = document.getElementById('myCanvas');
var ctx = canvas.getContext('2d');

//globally stored variables
var score = 0;
var lives = 3;
var x = canvas.width / 2;
var y = canvas.height - 30;
var dx = 2;
var dy = -2;
var ballRadius = 7.5;
var paddleHeight = 13;
var paddleWidth = 70;
var paddleX = (canvas.width - paddleWidth) / 2;
var paddleY = canvas.height - 10;
// ^ defines where the paddle begins on x-axis

//brick variables
var brickRowCount = 3;
var brickColumnCount = 5;
var brickWidth = 80;
var brickHeight = 20;
var brickPadding = 10;
var brickOffsetTop = 30;
var brickOffsetLeft = 30;

var bricks = [];
for (var c = 0; c < brickColumnCount; c++) {
    bricks[c] = [];
    for (var r = 0; r < brickRowCount; r++) {
        bricks[c][r] = {
            x: 0,
            y: 0,
            status: 1
        };
    }
}

var leftPress = false;
var rightPress = false;
//key presses for event listeners

document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);
document.addEventListener("mousemove", mouseMoveHandler, false);

function keyDownHandler(e) {
    if (e.keyCode == 39) {
        rightPress = true;
    } else if (e.keyCode == 37) {
        leftPress = true;
    }
}

function keyUpHandler(e) {
    if (e.keyCode == 39) {
        rightPress = false;
    } else if (e.keyCode == 37) {
        leftPress = false;
    }
}

function mouseMoveHandler(e) {
    var relativeX = e.clientX - canvas.offsetLeft;
    if (relativeX > 0 && relativeX < canvas.width) {
        paddleX = relativeX - paddleWidth / 2;
    }
}

function collisionDetection() {
    for (c = 0; c < brickColumnCount; c++) {
        for (r = 0; r < brickRowCount; r++) {
            var b = bricks[c][r];
            if (b.status == 1) {
                if (x > b.x && x < b.x + brickWidth && y > b.y && y < b.y + brickHeight + 25) {
                    dy = -dy;
                    b.status = 0;
                    score++;
                    if (score === brickRowCount * brickColumnCount) {
                        alert("YOU WIN, CONGRATULATIONS!");
                        document.location.reload();
                    }
                }
            }
        }
    }
}

function drawScore() {
    ctx.font = "1.2rem Helvetica";
    ctx.fillStyle = "limegreen";
    ctx.fillText("Score: " + score, 8, 22);
}

function drawLives() {
    ctx.font = "1.2rem Helvetica";
    ctx.fillStyle = "limegreen";
    ctx.fillText("Lives: " + lives, canvas.width - 75, 22);
}

function drawTitle() {
    // ctx.shadowColor = "black";
    // ctx.shadowOffsetX = 2;
    // ctx.shadowOffsetY = 2;
    // ctx.shadowBlur = 5;
    var text = "2D Breakout";
    ctx.font = "1.8rem Helvetica";
    ctx.fillStyle = "gray";
    ctx.fillText(text, 177, 30);
    ctx.fillStyle = "limegreen";
    ctx.fillText(text, 175, 28);
}

function drawBall() {
    ctx.beginPath();
    ctx.arc(x, y, 10, ballRadius, 0, Math.PI * 2, false);
    ctx.fillStyle = "#70777A";
    ctx.fill();
    ctx.closePath();
}

function drawPaddle() {
    ctx.beginPath();
    ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
    ctx.fillStyle = "#70777A";
    ctx.fill();
    ctx.closePath();
}

function drawBricks() {
    for (var c = 0; c < brickColumnCount; c++) {
        for (var r = 0; r < brickRowCount; r++) {
            if (bricks[c][r].status == 1) {
                var brickX = c * (brickWidth + brickPadding) + brickOffsetLeft;
                var brickY = r * (brickHeight + brickPadding) + brickOffsetTop;
                bricks[c][r].x = brickX;
                bricks[c][r].y = brickY;
                ctx.beginPath();
                ctx.rect(brickX, brickY + 15, brickWidth, brickHeight);
                ctx.fillStyle = "#70777A";
                ctx.fill();
                ctx.closePath();
            }
        }
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBricks();
    drawBall();
    drawPaddle();
    collisionDetection();
    drawScore();
    drawLives();
    drawTitle();
    x += dx;
    y += dy;

    if (y + dy < ballRadius) {
        //if ball position is greater than the height of the canvas, reverse y axis movement
        dy = -dy;
    } else if (y + dy > canvas.height - ballRadius) {
        if (x > paddleX && x < paddleX + paddleWidth) {
            //if ball is on x-axis where the paddle is
            dy = -dy;
        } else {
            lives--;
            if (!lives) {
                alert("YOU'RE KILLING ME SMALLS");
                document.location.reload();
            } else {
                x = canvas.width / 2;
                y = canvas.height - 30;
                dx = 2;
                dy = -2;
                paddleX = (canvas.width - paddleWidth) / 2;
            }
        }
    }

    if (x + dx > canvas.width - ballRadius || x + dx < ballRadius) {
        //if ball position is greater than the width of the canvas, reverse x axis movement
        dx = -dx;
    }

    if (rightPress && paddleX < canvas.width - paddleWidth) {
        paddleX += 6;
    } else if (leftPress && paddleX > 0) {
        paddleX -= 6;
    }
    requestAnimationFrame(draw);
    //gives control of framerate to browser rather than a static setinterval
}
draw();
// setInterval(draw, 10);
//set interval redraws the ball so that it appears to be moving


//code developed with help of https://developer.mozilla.org/en-US/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript/

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvc2NyaXB0cy9lbnRyeS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBSSxTQUFTLFNBQVMsY0FBVCxDQUF3QixVQUF4QixDQUFiO0FBQ0EsSUFBSSxNQUFNLE9BQU8sVUFBUCxDQUFrQixJQUFsQixDQUFWOztBQUVBO0FBQ0EsSUFBSSxRQUFRLENBQVo7QUFDQSxJQUFJLFFBQVEsQ0FBWjtBQUNBLElBQUksSUFBSSxPQUFPLEtBQVAsR0FBZSxDQUF2QjtBQUNBLElBQUksSUFBSSxPQUFPLE1BQVAsR0FBZ0IsRUFBeEI7QUFDQSxJQUFJLEtBQUssQ0FBVDtBQUNBLElBQUksS0FBSyxDQUFDLENBQVY7QUFDQSxJQUFJLGFBQWEsR0FBakI7QUFDQSxJQUFJLGVBQWUsRUFBbkI7QUFDQSxJQUFJLGNBQWMsRUFBbEI7QUFDQSxJQUFJLFVBQVUsQ0FBQyxPQUFPLEtBQVAsR0FBZSxXQUFoQixJQUErQixDQUE3QztBQUNBLElBQUksVUFBVyxPQUFPLE1BQVAsR0FBZ0IsRUFBL0I7QUFDQTs7QUFFQTtBQUNBLElBQUksZ0JBQWdCLENBQXBCO0FBQ0EsSUFBSSxtQkFBbUIsQ0FBdkI7QUFDQSxJQUFJLGFBQWEsRUFBakI7QUFDQSxJQUFJLGNBQWMsRUFBbEI7QUFDQSxJQUFJLGVBQWUsRUFBbkI7QUFDQSxJQUFJLGlCQUFpQixFQUFyQjtBQUNBLElBQUksa0JBQWtCLEVBQXRCOztBQUVBLElBQUksU0FBUyxFQUFiO0FBQ0EsS0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLGdCQUFwQixFQUFzQyxHQUF0QyxFQUEyQztBQUN2QyxXQUFPLENBQVAsSUFBWSxFQUFaO0FBQ0EsU0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLGFBQXBCLEVBQW1DLEdBQW5DLEVBQXdDO0FBQ3BDLGVBQU8sQ0FBUCxFQUFVLENBQVYsSUFBZTtBQUNYLGVBQUcsQ0FEUTtB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MEJBQXNCLElBQXRCO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTs7O0FBR0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteUNhbnZhcycpO1xubGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4vL2dsb2JhbGx5IHN0b3JlZCB2YXJpYWJsZXNcbmxldCBzY29yZSA9IDA7XG5sZXQgbGl2ZXMgPSAzO1xubGV0IHggPSBjYW52YXMud2lkdGggLyAyO1xubGV0IHkgPSBjYW52YXMuaGVpZ2h0IC0gMzA7XG5sZXQgZHggPSAyO1xubGV0IGR5ID0gLTI7XG5sZXQgYmFsbFJhZGl1cyA9IDcuNTtcbmxldCBwYWRkbGVIZWlnaHQgPSAxMztcbmxldCBwYWRkbGVXaWR0aCA9IDcwO1xubGV0IHBhZGRsZVggPSAoY2FudmFzLndpZHRoIC0gcGFkZGxlV2lkdGgpIC8gMjtcbmxldCBwYWRkbGVZID0gKGNhbnZhcy5oZWlnaHQgLSAxMCk7XG4vLyBeIGRlZmluZXMgd2hlcmUgdGhlIHBhZGRsZSBiZWdpbnMgb24geC1heGlzXG5cbi8vYnJpY2sgdmFyaWFibGVzXG5sZXQgYnJpY2tSb3dDb3VudCA9IDM7XG5sZXQgYnJpY2tDb2x1bW5Db3VudCA9IDU7XG5sZXQgYnJpY2tXaWR0aCA9IDgwO1xubGV0IGJyaWNrSGVpZ2h0ID0gMjA7XG5sZXQgYnJpY2tQYWRkaW5nID0gMTA7XG5sZXQgYnJpY2tPZmZzZXRUb3AgPSAzMDtcbmxldCBicmlja09mZnNldExlZnQgPSAzMDtcblxubGV0IGJyaWNrcyA9IFtdO1xuZm9yICh2YXIgYyA9IDA7IGMgPCBicmlja0NvbHVtbkNvdW50OyBjKyspIHtcbiAgICBicmlja3NbY10gPSBbXTtcbiAgICBmb3IgKHZhciByID0gMDsgciA8IGJyaWNrUm93Q291bnQ7IHIrKykge1xuICAgICAgICBicmlja3NbY11bcl0gPSB7XG4gICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgIHN0YXR1czogMVxuICAgICAgICB9O1xuICAgIH1cbn1cblxubGV0IGxlZnRQcmVzcyA9IGZhbHNlO1xubGV0IHJpZ2h0UHJlc3MgPSBmYWxzZTtcbi8va2V5IHByZXNzZXMgZm9yIGV2ZW50IGxpc3RlbmVyc1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBrZXlEb3duSGFuZGxlciwgZmFsc2UpO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGtleVVwSGFuZGxlciwgZmFsc2UpO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZU1vdmVIYW5kbGVyLCBmYWxzZSk7XG5cbmZ1bmN0aW9uIGtleURvd25IYW5kbGVyKGUpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09IDM5KSB7XG4gICAgICAgIHJpZ2h0UHJlc3MgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDM3KSB7XG4gICAgICAgIGxlZnRQcmVzcyA9IHRydWU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBrZXlVcEhhbmRsZXIoZSkge1xuICAgIGlmIChlLmtleUNvZGUgPT0gMzkpIHtcbiAgICAgICAgcmlnaHRQcmVzcyA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IDM3KSB7XG4gICAgICAgIGxlZnRQcmVzcyA9IGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbW91c2VNb3ZlSGFuZGxlcihlKSB7XG4gICAgdmFyIHJlbGF0aXZlWCA9IGUuY2xpZW50WCAtIGNhbnZhcy5vZmZzZXRMZWZ0O1xuICAgIGlmKHJlbGF0aXZlWCA+IDAgJiYgcmVsYXRpdmVYIDwgY2FudmFzLndpZHRoKSB7XG4gICAgICAgIHBhZGRsZVggPSByZWxhdGl2ZVggLSBwYWRkbGVXaWR0aC8yO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY29sbGlzaW9uRGV0ZWN0aW9uKCkge1xuICAgIGZvciAoYyA9IDA7IGMgPCBicmlja0NvbHVtbkNvdW50OyBjKyspIHtcbiAgICAgICAgZm9yIChyID0gMDsgciA8IGJyaWNrUm93Q291bnQ7IHIrKykge1xuICAgICAgICAgICAgdmFyIGIgPSBicmlja3NbY11bcl07XG4gICAgICAgICAgICBpZihiLnN0YXR1cyA9PSAxKSB7XG4gICAgICAgICAgICAgICAgaWYoeCA+IGIueCAmJiB4IDwgYi54K2JyaWNrV2lkdGggJiYgeSA+IGIueSAmJiB5IDwgYi55K2JyaWNrSGVpZ2h0KzI1KSB7XG4gICAgICAgICAgICAgICAgICAgIGR5ID0gLWR5O1xuICAgICAgICAgICAgICAgICAgICBiLnN0YXR1cyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHNjb3JlKys7XG4gICAgICAgICAgICAgICAgICAgIGlmKHNjb3JlID09PSBicmlja1Jvd0NvdW50KmJyaWNrQ29sdW1uQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJZT1UgV0lOLCBDT05HUkFUVUxBVElPTlMhXCIpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmF3U2NvcmUoKSB7XG4gICAgY3R4LmZvbnQgPSBcIjEuMnJlbSBIZWx2ZXRpY2FcIjtcbiAgICBjdHguZmlsbFN0eWxlID0gXCJsaW1lZ3JlZW5cIjtcbiAgICBjdHguZmlsbFRleHQoXCJTY29yZTogXCIrc2NvcmUsIDgsIDIyKTtcbn1cblxuZnVuY3Rpb24gZHJhd0xpdmVzKCkge1xuICAgIGN0eC5mb250ID0gXCIxLjJyZW0gSGVsdmV0aWNhXCI7XG4gICAgY3R4LmZpbGxTdHlsZSA9IFwibGltZWdyZWVuXCI7XG4gICAgY3R4LmZpbGxUZXh0KFwiTGl2ZXM6IFwiK2xpdmVzLCBjYW52YXMud2lkdGgtNzUsIDIyKTtcbn1cblxuZnVuY3Rpb24gZHJhd1RpdGxlKCkge1xuICAgIC8vIGN0eC5zaGFkb3dDb2xvciA9IFwiYmxhY2tcIjtcbiAgICAvLyBjdHguc2hhZG93T2Zmc2V0WCA9IDI7XG4gICAgLy8gY3R4LnNoYWRvd09mZnNldFkgPSAyO1xuICAgIC8vIGN0eC5zaGFkb3dCbHVyID0gNTtcbiAgICBsZXQgdGV4dCA9IFwiMkQgQnJlYWtvdXRcIlxuICAgIGN0eC5mb250ID0gXCIxLjhyZW0gSGVsdmV0aWNhXCI7XG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiZ3JheVwiO1xuICAgIGN0eC5maWxsVGV4dCh0ZXh0LCAxNzcsIDMwKTtcbiAgICBjdHguZmlsbFN0eWxlID0gXCJsaW1lZ3JlZW5cIjtcbiAgICBjdHguZmlsbFRleHQodGV4dCwgMTc1LCAyOCk7XG59XG5cbmZ1bmN0aW9uIGRyYXdCYWxsKCkge1xuICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICBjdHguYXJjKHgsIHksIDEwLCBiYWxsUmFkaXVzLCAwLCBNYXRoLlBJICogMiwgZmFsc2UpO1xuICAgIGN0eC5maWxsU3R5bGUgPSBcIiM3MDc3N0FcIjtcbiAgICBjdHguZmlsbCgpO1xuICAgIGN0eC5jbG9zZVBhdGgoKTtcbn1cblxuZnVuY3Rpb24gZHJhd1BhZGRsZSgpIHtcbiAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgY3R4LnJlY3QocGFkZGxlWCwgY2FudmFzLmhlaWdodCAtIHBhZGRsZUhlaWdodCwgcGFkZGxlV2lkdGgsIHBhZGRsZUhlaWdodCk7XG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiIzcwNzc3QVwiO1xuICAgIGN0eC5maWxsKCk7XG4gICAgY3R4LmNsb3NlUGF0aCgpO1xufVxuXG5mdW5jdGlvbiBkcmF3QnJpY2tzKCkge1xuICAgIGZvciAodmFyIGMgPSAwOyBjIDwgYnJpY2tDb2x1bW5Db3VudDsgYysrKSB7XG4gICAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgYnJpY2tSb3dDb3VudDsgcisrKSB7XG4gICAgICAgICAgICBpZiAoYnJpY2tzW2NdW3JdLnN0YXR1cyA9PSAxKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJyaWNrWCA9IChjICogKGJyaWNrV2lkdGggKyBicmlja1BhZGRpbmcpKSArIGJyaWNrT2Zmc2V0TGVmdDtcbiAgICAgICAgICAgICAgICB2YXIgYnJpY2tZID0gKHIgKiAoYnJpY2tIZWlnaHQgKyBicmlja1BhZGRpbmcpKSArIGJyaWNrT2Zmc2V0VG9wO1xuICAgICAgICAgICAgICAgIGJyaWNrc1tjXVtyXS54ID0gYnJpY2tYO1xuICAgICAgICAgICAgICAgIGJyaWNrc1tjXVtyXS55ID0gYnJpY2tZO1xuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjdHgucmVjdChicmlja1gsIGJyaWNrWSArIDE1LCBicmlja1dpZHRoLCBicmlja0hlaWdodCk7XG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiIzcwNzc3QVwiO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmF3KCkge1xuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICBkcmF3QnJpY2tzKCk7XG4gICAgZHJhd0JhbGwoKTtcbiAgICBkcmF3UGFkZGxlKCk7XG4gICAgY29sbGlzaW9uRGV0ZWN0aW9uKCk7XG4gICAgZHJhd1Njb3JlKCk7XG4gICAgZHJhd0xpdmVzKCk7XG4gICAgZHJhd1RpdGxlKCk7XG4gICAgeCArPSBkeDtcbiAgICB5ICs9IGR5O1xuXG4gICAgaWYgKHkgKyBkeSA8IGJhbGxSYWRpdXMpIHtcbiAgICAgICAgLy9pZiBiYWxsIHBvc2l0aW9uIGlzIGdyZWF0ZXIgdGhhbiB0aGUgaGVpZ2h0IG9mIHRoZSBjYW52YXMsIHJldmVyc2UgeSBheGlzIG1vdmVtZW50XG4gICAgICAgIGR5ID0gLWR5O1xuICAgIH0gZWxzZSBpZiAoeSArIGR5ID4gY2FudmFzLmhlaWdodCAtIGJhbGxSYWRpdXMpIHtcbiAgICAgICAgaWYgKHggPiBwYWRkbGVYICYmIHggPCBwYWRkbGVYICsgcGFkZGxlV2lkdGgpIHtcbiAgICAgICAgICAgIC8vaWYgYmFsbCBpcyBvbiB4LWF4aXMgd2hlcmUgdGhlIHBhZGRsZSBpc1xuICAgICAgICAgICAgZHkgPSAtZHk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGl2ZXMtLTtcbiAgICAgICAgICBpZighbGl2ZXMpIHtcbiAgICAgICAgICAgICAgYWxlcnQoXCJZT1UnUkUgS0lMTElORyBNRSBTTUFMTFNcIik7XG4gICAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgeCA9IGNhbnZhcy53aWR0aC8yO1xuICAgICAgICAgICAgICB5ID0gY2FudmFzLmhlaWdodC0zMDtcbiAgICAgICAgICAgICAgZHggPSAyO1xuICAgICAgICAgICAgICBkeSA9IC0yO1xuICAgICAgICAgICAgICBwYWRkbGVYID0gKGNhbnZhcy53aWR0aC1wYWRkbGVXaWR0aCkvMjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoeCArIGR4ID4gY2FudmFzLndpZHRoIC0gYmFsbFJhZGl1cyB8fCB4ICsgZHggPCBiYWxsUmFkaXVzKSB7XG4gICAgICAgIC8vaWYgYmFsbCBwb3NpdGlvbiBpcyBncmVhdGVyIHRoYW4gdGhlIHdpZHRoIG9mIHRoZSBjYW52YXMsIHJldmVyc2UgeCBheGlzIG1vdmVtZW50XG4gICAgICAgIGR4ID0gLWR4O1xuICAgIH1cblxuICAgIGlmIChyaWdodFByZXNzICYmIHBhZGRsZVggPCBjYW52YXMud2lkdGggLSBwYWRkbGVXaWR0aCkge1xuICAgICAgICBwYWRkbGVYICs9IDY7XG4gICAgfSBlbHNlIGlmIChsZWZ0UHJlc3MgJiYgcGFkZGxlWCA+IDApIHtcbiAgICAgICAgcGFkZGxlWCAtPSA2O1xuICAgIH1cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7XG4gICAgLy9naXZlcyBjb250cm9sIG9mIGZyYW1lcmF0ZSB0byBicm93c2VyIHJhdGhlciB0aGFuIGEgc3RhdGljIHNldGludGVydmFsXG59XG5kcmF3KCk7XG4vLyBzZXRJbnRlcnZhbChkcmF3LCAxMCk7XG4vL3NldCBpbnRlcnZhbCByZWRyYXdzIHRoZSBiYWxsIHNvIHRoYXQgaXQgYXBwZWFycyB0byBiZSBtb3ZpbmdcblxuXG4vL2NvZGUgZGV2ZWxvcGVkIHdpdGggaGVscCBvZiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0dhbWVzL1R1dG9yaWFscy8yRF9CcmVha291dF9nYW1lX3B1cmVfSmF2YVNjcmlwdC9cbiJdfQ==
